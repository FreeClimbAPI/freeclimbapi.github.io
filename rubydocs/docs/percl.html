<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Percl - FreeClimb Ruby SDK</title> <link rel="shortcut icon" href="http://localhost:4000/rubydocs/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="http://localhost:4000/rubydocs/assets/css/just-the-docs.css"> <script type="text/javascript" src="http://localhost:4000/rubydocs/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="http://localhost:4000/rubydocs/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Percl | FreeClimb Ruby SDK</title> <meta name="generator" content="Jekyll v3.8.5" /> <meta property="og:title" content="Percl" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Ruby SDK Documentation for the FreeClimb API" /> <meta property="og:description" content="Ruby SDK Documentation for the FreeClimb API" /> <link rel="canonical" href="http://localhost:4000/rubydocs/docs/percl.html" /> <meta property="og:url" content="http://localhost:4000/rubydocs/docs/percl.html" /> <meta property="og:site_name" content="FreeClimb Ruby SDK" /> <script type="application/ld+json"> {"headline":"Percl","url":"http://localhost:4000/rubydocs/docs/percl.html","description":"Ruby SDK Documentation for the FreeClimb API","@type":"WebPage","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="link" viewBox="0 0 16 16"> <title>Link</title> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path> </symbol> </svg> <div class="page-wrap"> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/rubydocs/" class="site-title lh-tight"> FreeClimb Ruby SDK </a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button> </div> <div class="navigation main-nav js-main-nav"> <nav role="navigation" aria-label="Main navigation"> <ul class="navigation-list"><li class="navigation-list-item"><a href="http://localhost:4000/rubydocs/" class="navigation-list-link">FreeClimb</a></li><li class="navigation-list-item active"><a href="http://localhost:4000/rubydocs/404.html" class="navigation-list-link"></a></li><li class="navigation-list-item"><a href="http://localhost:4000/rubydocs/docs/DefaultApi.html" class="navigation-list-link">Freeclimb::DefaultApi</a></li><li class="navigation-list-item active"><a href="http://localhost:4000/rubydocs/docs/percl.html" class="navigation-list-link active">Percl</a></li><li class="navigation-list-item"><a href="http://localhost:4000/rubydocs/models.html" class="navigation-list-link">Models</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/UpdateConferenceRequest.html" class="navigation-list-link">FreeClimb::UpdateConferenceRequest</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/AccountResult.html" class="navigation-list-link">Freeclimb::AccountResult</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/AccountResultAllOf.html" class="navigation-list-link">Freeclimb::AccountResultAllOf</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/ApplicationList.html" class="navigation-list-link">Freeclimb::ApplicationList</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/ApplicationListAllOf.html" class="navigation-list-link">Freeclimb::ApplicationListAllOf</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/ApplicationRequest.html" class="navigation-list-link">Freeclimb::ApplicationRequest</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/ApplicationResult.html" class="navigation-list-link">Freeclimb::ApplicationResult</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/ApplicationResultAllOf.html" class="navigation-list-link">Freeclimb::ApplicationResultAllOf</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/AvailableNumber.html" class="navigation-list-link">Freeclimb::AvailableNumber</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/AvailableNumberList.html" class="navigation-list-link">Freeclimb::AvailableNumberList</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/AvailableNumberListAllOf.html" class="navigation-list-link">Freeclimb::AvailableNumberListAllOf</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/BuyIncomingNumberRequest.html" class="navigation-list-link">Freeclimb::BuyIncomingNumberRequest</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/CallList.html" class="navigation-list-link">Freeclimb::CallList</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/CallListAllOf.html" class="navigation-list-link">Freeclimb::CallListAllOf</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/CallResult.html" class="navigation-list-link">Freeclimb::CallResult</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/CallResultAllOf.html" class="navigation-list-link">Freeclimb::CallResultAllOf</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/ConferenceList.html" class="navigation-list-link">Freeclimb::ConferenceList</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/ConferenceListAllOf.html" class="navigation-list-link">Freeclimb::ConferenceListAllOf</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/ConferenceParticipantList.html" class="navigation-list-link">Freeclimb::ConferenceParticipantList</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/ConferenceParticipantListAllOf.html" class="navigation-list-link">Freeclimb::ConferenceParticipantListAllOf</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/ConferenceParticipantResult.html" class="navigation-list-link">Freeclimb::ConferenceParticipantResult</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/ConferenceParticipantResultAllOf.html" class="navigation-list-link">Freeclimb::ConferenceParticipantResultAllOf</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/ConferenceResult.html" class="navigation-list-link">Freeclimb::ConferenceResult</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/ConferenceResultAllOf.html" class="navigation-list-link">Freeclimb::ConferenceResultAllOf</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/CreateConferenceRequest.html" class="navigation-list-link">Freeclimb::CreateConferenceRequest</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/DequeueMemberRequest.html" class="navigation-list-link">Freeclimb::DequeueMemberRequest</a></li><li class="navigation-list-item active"><a href="http://localhost:4000/rubydocs/docs/FilterLogsRequest.html" class="navigation-list-link"></a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/IncomingNumberList.html" class="navigation-list-link">FreeClimb::IncomingNumberList</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/IncomingNumberListAllOf.html" class="navigation-list-link">FreeClimb::IncomingNumberListAllOf</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/IncomingNumberRequest.html" class="navigation-list-link">FreeClimb::IncomingNumberRequest</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/IncomingNumberResult.html" class="navigation-list-link">FreeClimb::IncomingNumberResult</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/IncomingNumberResultAllOf.html" class="navigation-list-link">FreeClimb::IncomingNumberResultAllOf</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/LogList.html" class="navigation-list-link">FreeClimb::LogList</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/LogListAllOf.html" class="navigation-list-link">FreeClimb::LogListAllOf</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/LogResult.html" class="navigation-list-link">FreeClimb::LogResult</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/MakeCallRequest.html" class="navigation-list-link">FreeClimb::MakeCallRequest</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/MessageRequest.html" class="navigation-list-link">FreeClimb::MessageRequest</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/MessageRequestAllOf.html" class="navigation-list-link">FreeClimb::MessageRequestAllOf</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/MessageResult.html" class="navigation-list-link">FreeClimb::MessageResult</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/MessageResultAllOf.html" class="navigation-list-link">FreeClimb::MessageResultAllOf</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/MessagesList.html" class="navigation-list-link">FreeClimb::MessagesList</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/MessagesListAllOf.html" class="navigation-list-link">FreeClimb::MessagesListAllOf</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/MutableResourceModel.html" class="navigation-list-link">FreeClimb::MutableResourceModel</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/PaginationModel.html" class="navigation-list-link">FreeClimb::PaginationModel</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/QueueList.html" class="navigation-list-link">FreeClimb::QueueList</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/QueueListAllOf.html" class="navigation-list-link">FreeClimb::QueueListAllOf</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/QueueMember.html" class="navigation-list-link">FreeClimb::QueueMember</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/QueueMemberList.html" class="navigation-list-link">FreeClimb::QueueMemberList</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/QueueMemberListAllOf.html" class="navigation-list-link">FreeClimb::QueueMemberListAllOf</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/QueueRequest.html" class="navigation-list-link">FreeClimb::QueueRequest</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/QueueResult.html" class="navigation-list-link">FreeClimb::QueueResult</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/QueueResultAllOf.html" class="navigation-list-link">FreeClimb::QueueResultAllOf</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/RecordingList.html" class="navigation-list-link">FreeClimb::RecordingList</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/RecordingListAllOf.html" class="navigation-list-link">FreeClimb::RecordingListAllOf</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/RecordingResult.html" class="navigation-list-link">FreeClimb::RecordingResult</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/RecordingResultAllOf.html" class="navigation-list-link">FreeClimb::RecordingResultAllOf</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/UpdateCallRequest.html" class="navigation-list-link">FreeClimb::UpdateCallRequest</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/UpdateConferenceParticipantRequest.html" class="navigation-list-link">FreeClimb::UpdateConferenceParticipantRequest</a></li><li class="navigation-list-item "><a href="http://localhost:4000/rubydocs/docs/AccountRequest.html" class="navigation-list-link">Freeclimb::AccountRequest</a></li></ul></li></ul> </nav> </div> <footer class="site-footer"> <p class="text-small text-grey-dk-000 mb-4">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p> </footer> </div> <div class="main-content-wrap js-main-content" tabindex="0"> <div class="main-content"> <div class="page-header js-page-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search FreeClimb Ruby SDK" aria-label="Search FreeClimb Ruby SDK" autocomplete="off"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg> </div> <div class="js-search-results search-results-wrap"></div> </div> <ul class="list-style-none text-small aux-nav"> <li class="d-inline-block my-0"><a href="//github.com/FreeClimbAPI/ruby-sdk">FreeClimb Ruby SDK on GitHub</a></li> </ul> </div> <div class="page"> <div id="main-content" class="page-content" role="main"> <h1 id="percl"> <a href="#percl" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Percl </h1> <p>The Performance Command Language (PerCL) defines a set of instructions, written in JSON format, that express telephony actions to be performed in response to an event on the FreeClimb platform. FreeClimb communicates with the application server when events associated with the application occur, so the webserver can instruct FreeClimb how to handle such events using PerCL scripts.</p> <p>When creating a Percl object, required parameters must be used in the constructer while optional parameters must be set direclty on the given Percl object. Example:</p> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">digits</span> <span class="o">=</span> <span class="s1">'630'</span>
<span class="n">send_digits</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">SendDigits</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">digits</span><span class="p">)</span>
<span class="n">send_digits</span><span class="p">.</span><span class="nf">pauseMs</span> <span class="o">=</span> <span class="s1">'500'</span>
</code></pre></div></div> <h2 id="documentation-for-percl-responses"> <a href="#documentation-for-percl-responses" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Documentation for PerCL Responses </h2> <p>Class | Description<br /> ———— | ————-<br /> <a href="/rubydocs/docs/percl.html#percl::outdial"><em>Percl::OutDial</em></a> | The <code class="language-plaintext highlighter-rouge">OutDial</code> command is used to call a phone number <br /> <a href="/rubydocs/docs/percl.html#percl::hangup"><em>Percl::Hangup</em></a> | The <code class="language-plaintext highlighter-rouge">Hangup</code> command terminates a Call<br /> <a href="/rubydocs/docs/percl.html#percl::pause"><em>Percl::Pause</em></a> | The <code class="language-plaintext highlighter-rouge">Pause</code> command halts execution of the current PerCL script for a specified number of millisecond<br /> <a href="/rubydocs/docs/percl.html#percl::redirect"><em>Percl::Redirect</em></a> | The <code class="language-plaintext highlighter-rouge">Redirect</code> command transfers control of a Call to the PerCL at a different URL<br /> <a href="/rubydocs/docs/percl.html#percl::senddigits"><em>Percl::SendDigits</em></a> | The <code class="language-plaintext highlighter-rouge">SendDigits</code> command plays DTMF tones on a live Call. This is useful for navigating through IVR menus or dialing extensions<br /> <a href="/rubydocs/docs/percl.html#percl::reject"><em>Percl::Reject</em></a> | The <code class="language-plaintext highlighter-rouge">Reject</code> command blocks an incoming Call.<br /> <a href="/rubydocs/docs/percl.html#percl::createConference"><em>Percl::CreateConference</em></a> | The <code class="language-plaintext highlighter-rouge">CreateConference</code> command does exactly what its name implies — it creates an unpopulated Conference (one without any Participants).<br /> <a href="/rubydocs/docs/percl.html#percl::terminateConference"><em>Percl::TerminateConference</em></a> | The <code class="language-plaintext highlighter-rouge">TerminateConference</code> command terminates an existing Conference.<br /> <a href="/rubydocs/docs/percl.html#percl::addToConference"><em>Percl::AddToConference</em></a> | The <code class="language-plaintext highlighter-rouge">AddToConference</code> command adds a Participant to a Conference.<br /> <a href="/rubydocs/docs/percl.html#percl::removeFromConference"><em>Percl::RemoveFromConference</em></a> | The <code class="language-plaintext highlighter-rouge">RemoveFromConference</code> command removes a Participant from a Conference but does not hang up.<br /> <a href="/rubydocs/docs/percl.html#percl::setListen"><em>Percl::SetListen</em></a> | The <code class="language-plaintext highlighter-rouge">SetListen</code> command enables or disables the listen privilege for a Conference Participant provided both calls are in the same conference. <br /> <a href="/rubydocs/docs/percl.html#percl::setTalk"><em>Percl::SetTalk</em></a> | The <code class="language-plaintext highlighter-rouge">SetTalk</code> command enables or disables the talk privilege for a Participant in a Conference provided both calls are in the same conference.<br /> <a href="/rubydocs/docs/percl.html#percl::enqueue"><em>Percl::Enqueue</em></a> | The <code class="language-plaintext highlighter-rouge">Enqueue</code> command adds the current Call to a call Queue.<br /> <a href="/rubydocs/docs/percl.html#percl::dequeue"><em>Percl::Dequeue</em></a> | The <code class="language-plaintext highlighter-rouge">Dequeue</code> command transfers control of a Call that is in a Queue so that the waiting caller exits the Queue.<br /> <a href="/rubydocs/docs/percl.html#percl::recordUtterance"><em>Percl::RecordUtterance</em></a> | The <code class="language-plaintext highlighter-rouge">RecordUtterance</code> command records the caller’s voice and returns the URL of a file containing the audio recording.<br /> <a href="/rubydocs/docs/percl.html#percl::startRecordCall"><em>Percl::StartRecordCall</em></a> | The <code class="language-plaintext highlighter-rouge">StartRecordCall</code> command records the current call and returns the URL of a file containing the audio recording when recording completes.<br /> <a href="/rubydocs/docs/percl.html#percl::playEarlyMedia"><em>Percl::PlayEarlyMedia</em></a> | The <code class="language-plaintext highlighter-rouge">PlayEarlyMedia</code> command plays A media file before attempting to connect a call<br /> <a href="/rubydocs/docs/percl.html#percl::play"><em>Percl::Play</em></a> | the <code class="language-plaintext highlighter-rouge">Play</code> command plays an audio file back to the caller.<br /> <a href="/rubydocs/docs/percl.html#percl::say"><em>Percl::Say</em></a> | The <code class="language-plaintext highlighter-rouge">Say</code> command provides Text-To-Speech (TTS) support. It converts text to speech and then renders it in a female voice back to the caller.<br /> <a href="/rubydocs/docs/percl.html#percl::getDigits"><em>Percl::GetDigits</em></a> | The <code class="language-plaintext highlighter-rouge">GetDigits</code> command collects DTMF inputs from the caller.<br /> <a href="/rubydocs/docs/percl.html#percl::getSpeech"><em>Percl::GetSpeech</em></a> | The <code class="language-plaintext highlighter-rouge">GetSpeech</code> command enables the Caller to respond to the application using a supported language.<br /> <a href="/rubydocs/docs/percl.html#percl::Sms"><em>Percl::Sms</em></a> | The <code class="language-plaintext highlighter-rouge">Sms</code> command can be used to send an SMS message to a phone number during a phone call.</p> <h2 id="percloutdial"> <a href="#percloutdial" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Percl::OutDial </h2> <p>The OutDial command is used to call a phone number</p> <h3 id="example"> <a href="#example" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Example </h3> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load the gems</span>
<span class="nb">require</span> <span class="s1">'sinatra'</span>
<span class="nb">require</span> <span class="s1">'freeclimb'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">post</span> <span class="s1">'/voice'</span> <span class="k">do</span> 
  <span class="n">out_dial</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">OutDial</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'MOCK_ACTION_URL'</span><span class="p">,</span> <span class="s1">'MOCK_CALL_CONNECT_URL'</span><span class="p">,</span> <span class="s1">'MOCK_CALLING_NUMBER'</span><span class="p">,</span> <span class="s1">'MOCK_DESTINATION'</span><span class="p">)</span>
  <span class="n">script</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Script</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">out_dial</span><span class="p">)</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">to_json</span>
<span class="k">end</span>
</code></pre></div></div> <h3 id="parameters"> <a href="#parameters" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Parameters </h3> <p>Name | Type | Description | Notes<br /> ————- | ————- | ————- | ————-<br /> <strong>actionUrl</strong> | <strong>String</strong>| URL to which FreeClimb sends an HTTP POST request. <br /> <strong>callConnectUrl</strong> | <strong>String</strong>| URL to which FreeClimb makes an HTTP POST request informing the result of the OutDial.<br /> <strong>callingNumber</strong> | <strong>String</strong> | The caller ID to show to the called party when FreeClimb calls. This can be one of the following: The To or From number provided in the first Webhook to your webserver. Any phone number you have purchased from FreeClimb.<br /> <strong>destination</strong> | <strong>String</strong> | E.164 representation of the phone number to Call. <br /> <strong>ifMachine</strong> | <strong>String</strong> | Specifies how FreeClimb should handle this OutDial if an answering machine answers the Call. Valid values: <code class="language-plaintext highlighter-rouge">redirect</code> invokes the ifMachineUrl for instructions. <code class="language-plaintext highlighter-rouge">hangup</code> hangs up the Call. The ifMachineUrl will not be invoked. | [optional]<br /> <strong>ifMachineUrl</strong> | <strong>String</strong> | When the <code class="language-plaintext highlighter-rouge">ifMachine</code> flag is set to <code class="language-plaintext highlighter-rouge">redirect</code>, this attribute specifies a URL to which FreeClimb makes a POST request when an answering machine or a fax machine is detected. This URL is required if the <code class="language-plaintext highlighter-rouge">ifMachine</code> flag is set to <code class="language-plaintext highlighter-rouge">redirect</code>. Otherwise, it should not be included. | [required if <code class="language-plaintext highlighter-rouge">ifMachine</code> is set to <code class="language-plaintext highlighter-rouge">redirect</code>]<br /> <strong>sendDigits</strong> | <strong>String</strong> | DTMF tones to play to the outdialed Call. This is typically used to dial a number and then dial an extension. | [optional]<br /> <strong>statusCallBackUrl</strong> | <strong>String</strong> | When the outdialed Call leg terminates, FreeClimb sends a <code class="language-plaintext highlighter-rouge">callStatus</code> Webhook to the <code class="language-plaintext highlighter-rouge">statusCallbackUrl</code>. This is a notification only; any PerCL command returned is ignored. | [optional]<br /> <strong>timeout</strong> | <strong>String</strong> | Maximum time in seconds the <code class="language-plaintext highlighter-rouge">OutDial</code> command waits for the called party to answer the Call. When a timeout occurs, FreeClimb invokes the <code class="language-plaintext highlighter-rouge">callConnectUrl</code> Webhook to report that the out-dialed Call has ended with a status of <code class="language-plaintext highlighter-rouge">noAnswer</code>. | [optional]</p> <h2 id="perclhangup"> <a href="#perclhangup" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Percl::Hangup </h2> <p>The Hangup command terminates a Call</p> <h3 id="example-1"> <a href="#example-1" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Example </h3> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load the gems</span>
<span class="nb">require</span> <span class="s1">'sinatra'</span>
<span class="nb">require</span> <span class="s1">'freeclimb'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">post</span> <span class="s1">'/voice'</span> <span class="k">do</span> 
  <span class="n">hangup</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Hangup</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">script</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Script</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">out_dial</span><span class="p">)</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">to_json</span>
<span class="k">end</span>
</code></pre></div></div> <h3 id="parameters-1"> <a href="#parameters-1" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Parameters </h3> <p>Name | Type | Description | Notes<br /> ————- | ————- | ————- | ————-<br /> <strong>callId</strong> | <strong>String</strong> | The ID of the Call leg to hang up. If not specified, the Call leg corresponding to the current PerCL execution context hangs up. | [optional]<br /> <strong>reason</strong> | <strong>String</strong> | The user defined reason for the hangup. In general, applications should use a set of enumerated values that are predefined to cover all exit points of the Call flows for the given application. | [optional]</p> <h2 id="perclpause"> <a href="#perclpause" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Percl::Pause </h2> <p>The <code class="language-plaintext highlighter-rouge">Pause</code> command halts execution of the current PerCL script for a specified number of milliseconds. If <code class="language-plaintext highlighter-rouge">Pause</code> is the first command in a PerCL document, FreeClimb will wait for the specified time to elapse before picking up the call.</p> <h3 id="example-2"> <a href="#example-2" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Example </h3> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load the gems</span>
<span class="nb">require</span> <span class="s1">'sinatra'</span>
<span class="nb">require</span> <span class="s1">'freeclimb'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">post</span> <span class="s1">'/voice'</span> <span class="k">do</span> 
  <span class="n">pause</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Pause</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
  <span class="n">script</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Script</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">out_dial</span><span class="p">)</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">to_json</span>
<span class="k">end</span>
</code></pre></div></div> <h3 id="parameters-2"> <a href="#parameters-2" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Parameters </h3> <p>Name | Type | Description | Notes<br /> ————- | ————- | ————- | ————-<br /> <strong>length</strong> | <strong>Integer</strong> | Length in milliseconds. FreeClimb will wait silently before continuing on.</p> <h2 id="perclredirect"> <a href="#perclredirect" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Percl::Redirect </h2> <p>The <code class="language-plaintext highlighter-rouge">Redirect</code> command transfers control of a Call to the PerCL at a different URL. <code class="language-plaintext highlighter-rouge">Redirect</code> is a terminal command, so any actions following it are never executed.</p> <h3 id="example-3"> <a href="#example-3" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Example </h3> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load the gems</span>
<span class="nb">require</span> <span class="s1">'sinatra'</span>
<span class="nb">require</span> <span class="s1">'freeclimb'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">post</span> <span class="s1">'/voice'</span> <span class="k">do</span> 
  <span class="n">redirect</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Redirect</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'MOCK_REDIRECT_URL'</span><span class="p">)</span>
  <span class="n">script</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Script</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">redirect</span><span class="p">)</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">to_json</span>
<span class="k">end</span>
</code></pre></div></div> <h3 id="parameters-3"> <a href="#parameters-3" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Parameters </h3> <p>Name | Type | Description | Notes<br /> ————- | ————- | ————- | ————-<br /> <strong>actionUrl</strong> | <strong>String</strong> | URL to request a new PerCL script to continue with the current Call’s processing. When <code class="language-plaintext highlighter-rouge">Redirect</code> invokes the <code class="language-plaintext highlighter-rouge">actionUrl</code>, an <code class="language-plaintext highlighter-rouge">inbound</code> Webhook is sent.</p> <h2 id="perclsenddigits"> <a href="#perclsenddigits" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Percl::SendDigits </h2> <p>The <code class="language-plaintext highlighter-rouge">SendDigits</code> command plays DTMF tones on a live Call. This is useful for navigating through IVR menus or dialing extensions.</p> <h3 id="example-4"> <a href="#example-4" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Example </h3> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load the gems</span>
<span class="nb">require</span> <span class="s1">'sinatra'</span>
<span class="nb">require</span> <span class="s1">'freeclimb'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">post</span> <span class="s1">'/voice'</span> <span class="k">do</span> 
  <span class="nb">send</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">SendDigits</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'12367#'</span><span class="p">)</span>
  <span class="n">script</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Script</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="nb">send</span><span class="p">)</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">to_json</span>
<span class="k">end</span>
</code></pre></div></div> <h3 id="parameters-4"> <a href="#parameters-4" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Parameters </h3> <div class="table-wrapper"><table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Notes</th> </tr> </thead> <tbody> <tr> <td><strong>digits</strong></td> <td><strong>String</strong></td> <td>String containing the digits to be played. The string cannot be empty and can include any digit, plus <code class="language-plaintext highlighter-rouge">#</code>, or <code class="language-plaintext highlighter-rouge">*</code>, and allows embedding specification for delay or pause between the output of individual digits.</td> <td> </td> </tr> <tr> <td><strong>pauseMs</strong></td> <td><strong>Integer</strong></td> <td>Pause between digits in milliseconds. Valid values are 100-1000 milliseconds and will be adjusted by FreeClimb to satisfy the constraint.</td> <td>[optional]</td> </tr> </tbody> </table></div> <h2 id="perclreject"> <a href="#perclreject" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Percl::Reject </h2> <p>The <code class="language-plaintext highlighter-rouge">Reject</code> command blocks an incoming Call. Using <code class="language-plaintext highlighter-rouge">Reject</code> is the only way to prevent FreeClimb from answering a Call. Any other response will result in an answered Call and your account will be billed.</p> <h3 id="example-5"> <a href="#example-5" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Example </h3> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load the gems</span>
<span class="nb">require</span> <span class="s1">'sinatra'</span>
<span class="nb">require</span> <span class="s1">'freeclimb'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">post</span> <span class="s1">'/voice'</span> <span class="k">do</span> 
  <span class="n">reject</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Reject</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">script</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Script</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">reject</span><span class="p">)</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">to_json</span>
<span class="k">end</span>
</code></pre></div></div> <h3 id="parameters-5"> <a href="#parameters-5" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Parameters </h3> <div class="table-wrapper"><table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Notes</th> </tr> </thead> <tbody> <tr> <td><strong>reason</strong></td> <td><strong>String</strong></td> <td>Reason for the rejection. This can be any string value. In general, applications should use a set of enumerated values that are predefined to cover all exit points of the call flows for the given application.</td> <td>[optional]</td> </tr> </tbody> </table></div> <h2 id="perclcreateconference"> <a href="#perclcreateconference" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Percl::CreateConference </h2> <p>The <code class="language-plaintext highlighter-rouge">CreateConference</code> command does exactly what its name implies — it creates an unpopulated Conference (one without any Participants). Once created, a Conference remains in FreeClimb until explicitly terminated by a customer. Once a Conference has been terminated, it can no longer be used.</p> <h3 id="example-6"> <a href="#example-6" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Example </h3> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load the gems</span>
<span class="nb">require</span> <span class="s1">'sinatra'</span>
<span class="nb">require</span> <span class="s1">'freeclimb'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">post</span> <span class="s1">'/voice'</span> <span class="k">do</span> 
  <span class="n">create_conference</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">CreateConference</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'MOCK_ACTION_URL'</span><span class="p">)</span>
  <span class="n">script</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Script</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">create_conference</span><span class="p">)</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">to_json</span>
<span class="k">end</span>
</code></pre></div></div> <h3 id="parameters-6"> <a href="#parameters-6" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Parameters </h3> <div class="table-wrapper"><table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Notes</th> </tr> </thead> <tbody> <tr> <td><strong>actionUrl</strong></td> <td><strong>String</strong></td> <td>This URL is invoked once the Conference is successfully created. Actions on the Conference, such as adding Participants, can be performed via the PerCL script returned in the response.</td> <td> </td> </tr> <tr> <td><strong>alias</strong></td> <td><strong>String</strong></td> <td>Descriptive name for the Conference.</td> <td>[optional]</td> </tr> <tr> <td><strong>playBeep</strong></td> <td><strong>String</strong></td> <td>Indicates whether to play a beep when a Participant enters or leaves the Conference. either <code class="language-plaintext highlighter-rouge">always</code>, <code class="language-plaintext highlighter-rouge">never</code>, <code class="language-plaintext highlighter-rouge">entryOnly</code>, or <code class="language-plaintext highlighter-rouge">exitOnly</code>. Leaving this unset will make conference default to <code class="language-plaintext highlighter-rouge">always</code></td> <td>[optional]</td> </tr> <tr> <td><strong>record</strong></td> <td><strong>String</strong></td> <td>When set to <code class="language-plaintext highlighter-rouge">true</code>, the entire Conference is recorded. The <code class="language-plaintext highlighter-rouge">statusCallbackUrl</code> of the Conference will receive a <code class="language-plaintext highlighter-rouge">conferenceRecordingEnded</code> Webhook when the Conference transitions from the <code class="language-plaintext highlighter-rouge">inProgress</code> to empty state.</td> <td>[optional]</td> </tr> <tr> <td><strong>waitUrl</strong></td> <td><strong>String</strong></td> <td>If specified, this URL provides the custom hold music for the Conference when it is in the populated state. This attribute is always fetched using HTTP GET and is fetched just once – when the Conference is created. The URL must be an audio file that is reachable and readable by FreeClimb.</td> <td>[optional]</td> </tr> <tr> <td><strong>statusCallbackUrl</strong></td> <td><strong>String</strong></td> <td>This URL is invoked when the status of the Conference changes or when a recording of the Conference has become available.</td> <td>[optional]</td> </tr> </tbody> </table></div> <h2 id="perclterminateconference"> <a href="#perclterminateconference" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Percl::TerminateConference </h2> <p>The <code class="language-plaintext highlighter-rouge">TerminateConference</code> command terminates an existing Conference. Any active participants are hung up on by FreeClimb. If this is not the desired behavior, use the <code class="language-plaintext highlighter-rouge">RemoveFromConference</code> command to unbridge Calls that should not be hung up.</p> <p>Note: The Call requesting TerminateConference must be on the same Conference for this command to execute.</p> <h3 id="example-7"> <a href="#example-7" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Example </h3> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load the gems</span>
<span class="nb">require</span> <span class="s1">'sinatra'</span>
<span class="nb">require</span> <span class="s1">'freeclimb'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">post</span> <span class="s1">'/voice'</span> <span class="k">do</span> 
  <span class="n">terminate</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">TerminateConference</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'MOCK_CONFERENCE_ID'</span><span class="p">)</span>
  <span class="n">script</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Script</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">terminate</span><span class="p">)</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">to_json</span>
<span class="k">end</span>
</code></pre></div></div> <h3 id="parameters-7"> <a href="#parameters-7" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Parameters </h3> <div class="table-wrapper"><table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Notes</th> </tr> </thead> <tbody> <tr> <td><strong>conferenceId</strong></td> <td><strong>String</strong></td> <td>ID of the conference to terminate.</td> <td> </td> </tr> </tbody> </table></div> <h2 id="percladdtoconference"> <a href="#percladdtoconference" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Percl::AddToConference </h2> <p>The <code class="language-plaintext highlighter-rouge">AddToConference</code> command adds a Participant to a Conference. If this Participant currently is in another Conference, the Participant is first removed from that Conference. Two Call legs can be bridged together by creating a Conference and adding both Call legs to it via <code class="language-plaintext highlighter-rouge">AddToConference</code>.</p> <h3 id="example-8"> <a href="#example-8" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Example </h3> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load the gems</span>
<span class="nb">require</span> <span class="s1">'sinatra'</span>
<span class="nb">require</span> <span class="s1">'freeclimb'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">post</span> <span class="s1">'/voice'</span> <span class="k">do</span> 
  <span class="c1"># Assuming Conference is already created</span>
  <span class="n">add</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">AddToConference</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'MOCK_CONF_ID'</span><span class="p">,</span> <span class="s1">'MOCK_CALL_ID'</span><span class="p">)</span>
  <span class="n">script</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Script</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">add</span><span class="p">)</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">to_json</span>
<span class="k">end</span>
</code></pre></div></div> <h3 id="parameters-8"> <a href="#parameters-8" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Parameters </h3> <div class="table-wrapper"><table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Notes</th> </tr> </thead> <tbody> <tr> <td><strong>conferenceId</strong></td> <td><strong>String</strong></td> <td>ID of the Conference to which to add the Participant (Call leg). Conference must exist or an error will result.</td> <td> </td> </tr> <tr> <td><strong>callId</strong></td> <td><strong>String</strong></td> <td>ID of the Call that will be added to the specified Conference. The Call must be in progress or an error will result. If the Call is part of an existing Conference, it is first removed from that Conference and is then moved to the new one.</td> <td> </td> </tr> <tr> <td><strong>startConfOnEnter</strong></td> <td><strong>Boolean</strong></td> <td>Flag that indicates whether a Conference starts upon entry of this particular Participant. This is usually set to <code class="language-plaintext highlighter-rouge">true</code> for moderators and <code class="language-plaintext highlighter-rouge">false</code> for all other Participants.</td> <td>[optional]</td> </tr> <tr> <td><strong>talk</strong></td> <td><strong>Boolean</strong></td> <td>If <code class="language-plaintext highlighter-rouge">true</code>, the Participant joins the Conference with talk privileges. This may be modified later via the REST API or <code class="language-plaintext highlighter-rouge">SetTalk</code> PerCL command.</td> <td>[optional]</td> </tr> <tr> <td><strong>listen</strong></td> <td><strong>Boolean</strong></td> <td>If <code class="language-plaintext highlighter-rouge">true</code>, the Participant joins the Conference with listen privileges. This may be modified later via the REST API or <code class="language-plaintext highlighter-rouge">SetListen</code> PerCL command.</td> <td>[optional]</td> </tr> <tr> <td><strong>allowCallControl</strong></td> <td><strong>Boolean</strong></td> <td>If <code class="language-plaintext highlighter-rouge">true</code>, Call control will be enabled for this Participant’s Call leg.</td> <td>[optional]</td> </tr> <tr> <td><strong>callControlSequence</strong></td> <td><strong>String</strong></td> <td>Defines a sequence of digits that, when entered by this caller, invokes the <code class="language-plaintext highlighter-rouge">callControlUrl</code>. Only digits plus ‘*’, and ‘#’ may be used.</td> <td>[<code class="language-plaintext highlighter-rouge">required</code> if allowCallControl is <code class="language-plaintext highlighter-rouge">true</code>]</td> </tr> <tr> <td><strong>callControlUrl</strong></td> <td><strong>String</strong></td> <td>URL to be invoked when this Participant enters the digit sequence defined in the <code class="language-plaintext highlighter-rouge">callControlSequence</code> attribute.</td> <td>[<code class="language-plaintext highlighter-rouge">required</code> if allowCallControl is <code class="language-plaintext highlighter-rouge">true</code>]</td> </tr> <tr> <td><strong>leaveConferenceUrl</strong></td> <td><strong>String</strong></td> <td>URL to be invoked when the Participant leaves the Conference.</td> <td>[optional]</td> </tr> <tr> <td><strong>notificationUrl</strong></td> <td><strong>String</strong></td> <td>When the Participant enters the Conference, this URL will be invoked using an HTTP POST request with the standard request parameters.</td> <td>[optional]</td> </tr> </tbody> </table></div> <h2 id="perclremovefromconference"> <a href="#perclremovefromconference" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Percl::RemoveFromConference </h2> <p>The <code class="language-plaintext highlighter-rouge">RemoveFromConference</code> command removes a Participant from a Conference but does not hang up. Instead, the Call is simply unbridged and what happens next with the Call is determined by the PerCL returned in response to the <code class="language-plaintext highlighter-rouge">leaveConferenceUrl</code> attribute.</p> <h3 id="example-9"> <a href="#example-9" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Example </h3> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load the gems</span>
<span class="nb">require</span> <span class="s1">'sinatra'</span>
<span class="nb">require</span> <span class="s1">'freeclimb'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">post</span> <span class="s1">'/voice'</span> <span class="k">do</span> 
  <span class="c1"># Assuming Conference is already created and participant is in conference</span>
  <span class="n">remove</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">RemoveFromConference</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'MOCK_CALL_ID'</span><span class="p">)</span>
  <span class="n">script</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Script</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">remove</span><span class="p">)</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">to_json</span>
<span class="k">end</span>
</code></pre></div></div> <h3 id="parameters-9"> <a href="#parameters-9" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Parameters </h3> <p>Name | Type | Description | Notes<br /> ————- | ————- | ————- | ————-<br /> <strong>callId</strong> | <strong>String</strong> | ID of the Call leg to be removed from the Conference. The Call must be in a Conference or an error will be triggered.</p> <h2 id="perclsetlisten"> <a href="#perclsetlisten" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Percl::SetListen </h2> <p>The <code class="language-plaintext highlighter-rouge">SetListen</code> command enables or disables the listen privilege for a Conference Participant provided both calls are in the same conference. The Participant can hear what the other participants are saying only if this privilege is enabled.</p> <h3 id="example-10"> <a href="#example-10" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Example </h3> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load the gems</span>
<span class="nb">require</span> <span class="s1">'sinatra'</span>
<span class="nb">require</span> <span class="s1">'freeclimb'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">post</span> <span class="s1">'/voice'</span> <span class="k">do</span> 
  <span class="c1"># Assuming Conference is already created and participant is in conference</span>
  <span class="n">listen</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">SetListen</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'MOCK_CALL_ID'</span><span class="p">)</span>
  <span class="n">script</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Script</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">listen</span><span class="p">)</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">to_json</span>
<span class="k">end</span>
</code></pre></div></div> <h3 id="parameters-10"> <a href="#parameters-10" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Parameters </h3> <p>Name | Type | Description | Notes<br /> ————- | ————- | ————- | ————-<br /> <strong>callId</strong> | <strong>String</strong> | ID of the call leg that is to be assigned the listen privilege. The Call must be in a Conference or an error will be triggered.<br /> <strong>listen</strong> | <strong>Boolean</strong> | Specifying <code class="language-plaintext highlighter-rouge">false</code> will silence the Conference for this Participant. | [optional]</p> <h2 id="perclsettalk"> <a href="#perclsettalk" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Percl::SetTalk </h2> <p>The <code class="language-plaintext highlighter-rouge">SetTalk</code> command enables or disables the talk privilege for a Participant in a Conference provided both calls are in the same conference. If ‘true’, no audio from that Participant is shared with the other Participants of the Conference.</p> <h3 id="example-11"> <a href="#example-11" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Example </h3> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load the gems</span>
<span class="nb">require</span> <span class="s1">'sinatra'</span>
<span class="nb">require</span> <span class="s1">'freeclimb'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">post</span> <span class="s1">'/voice'</span> <span class="k">do</span> 
  <span class="c1"># Assuming Conference is already created and participant is in conference</span>
  <span class="n">talk</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">SetTalk</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'MOCK_CALL_ID'</span><span class="p">)</span>
  <span class="n">script</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Script</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">talk</span><span class="p">)</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">to_json</span>
<span class="k">end</span>
</code></pre></div></div> <h3 id="parameters-11"> <a href="#parameters-11" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Parameters </h3> <p>Name | Type | Description | Notes<br /> ————- | ————- | ————- | ————-<br /> <strong>callId</strong> | <strong>String</strong> | ID of the call leg that is to be muted or unmuted. The Call must be in a Conference or an error will be triggered.<br /> <strong>talk</strong> | <strong>Boolean</strong> | Specifying <code class="language-plaintext highlighter-rouge">false</code> mutes the Participant. | [optional]</p> <h2 id="perclenqueue"> <a href="#perclenqueue" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Percl::Enqueue </h2> <p>The <code class="language-plaintext highlighter-rouge">Enqueue</code> command adds the current Call to a call Queue. If the specified Queue does not exist, it is created and then the Call is added to it. The default maximum length of the queue is 100. This can be modified using the REST API.</p> <h3 id="example-12"> <a href="#example-12" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Example </h3> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load the gems</span>
<span class="nb">require</span> <span class="s1">'sinatra'</span>
<span class="nb">require</span> <span class="s1">'freeclimb'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">post</span> <span class="s1">'/voice'</span> <span class="k">do</span> 
  <span class="c1"># Assuming Queue is already created</span>
  <span class="n">enqueue</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Enqueue</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'MOCK_QUEUE_ID'</span><span class="p">,</span> <span class="s1">'MOCK_WAIT_URL'</span><span class="p">,</span> <span class="s1">'MOCK_ACTION_URL'</span><span class="p">)</span>
  <span class="n">script</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Script</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">enqueue</span><span class="p">)</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">to_json</span>
<span class="k">end</span>
</code></pre></div></div> <h3 id="parameters-12"> <a href="#parameters-12" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Parameters </h3> <div class="table-wrapper"><table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Notes</th> </tr> </thead> <tbody> <tr> <td><strong>queueId</strong></td> <td><strong>String</strong></td> <td>ID of the Queue to which to add the Call. If the Queue does not exist, it will be created. The ID must start with QU followed by 40 hex characters.</td> <td> </td> </tr> <tr> <td><strong>waitUrl</strong></td> <td><strong>String</strong></td> <td>Specifies a URL pointing to a PerCL script containing actions to be executed while the caller is waiting in the Queue. Once the script returned by the <code class="language-plaintext highlighter-rouge">waitUrl</code> runs out of commands to execute, FreeClimb will re-request the <code class="language-plaintext highlighter-rouge">waitUrl</code> and start over, essentially looping the script indefinitely.</td> <td> </td> </tr> <tr> <td><strong>actionUrl</strong></td> <td><strong>String</strong></td> <td>A request is made to this URL when the Call leaves the Queue, which can occur if enqueue of the Call fails or when the call is dequeued via the <code class="language-plaintext highlighter-rouge">Dequeue</code> command, the REST API (POST to Queue Member resource), or the caller hangs up.</td> <td> </td> </tr> <tr> <td><strong>notificationUrl</strong></td> <td><strong>String</strong></td> <td>URL to be invoked when the call enters the queue. The request to the URL contains the standard request parameters.This is a notification only; any PerCL returned will be ignored.</td> <td>[optional]</td> </tr> </tbody> </table></div> <h2 id="percldequeue"> <a href="#percldequeue" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Percl::Dequeue </h2> <p>The <code class="language-plaintext highlighter-rouge">Dequeue</code> command transfers control of a Call that is in a Queue so that the waiting caller exits the Queue. Execution continues with the first command in the PerCL script returned by the <code class="language-plaintext highlighter-rouge">actionUrl</code> specified in the <code class="language-plaintext highlighter-rouge">Enqueue</code> command.</p> <h3 id="example-13"> <a href="#example-13" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Example </h3> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load the gems</span>
<span class="nb">require</span> <span class="s1">'sinatra'</span>
<span class="nb">require</span> <span class="s1">'freeclimb'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">post</span> <span class="s1">'/voice'</span> <span class="k">do</span> 
  <span class="c1"># Assuming call is in queue</span>
  <span class="n">dequeue</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Dequeue</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">script</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Script</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">dequeue</span><span class="p">)</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">to_json</span>
<span class="k">end</span>
</code></pre></div></div> <h3 id="parameters-13"> <a href="#parameters-13" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Parameters </h3> <p>none</p> <h2 id="perclrecordutterance"> <a href="#perclrecordutterance" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Percl::RecordUtterance </h2> <p>The <code class="language-plaintext highlighter-rouge">RecordUtterance</code> command records the caller’s voice and returns the URL of a file containing the audio recording.</p> <p><code class="language-plaintext highlighter-rouge">RecordUtterance</code> is blocking and is a terminal command. As such, the <code class="language-plaintext highlighter-rouge">actionUrl</code> property is required, and control of the Call picks up using the PerCL returned in response to the <code class="language-plaintext highlighter-rouge">actionUrl</code>. Recording information is returned in the <code class="language-plaintext highlighter-rouge">actionUrl</code> request.</p> <h3 id="example-14"> <a href="#example-14" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Example </h3> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load the gems</span>
<span class="nb">require</span> <span class="s1">'sinatra'</span>
<span class="nb">require</span> <span class="s1">'freeclimb'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">post</span> <span class="s1">'/voice'</span> <span class="k">do</span> 
  <span class="n">record</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">RecordUtterance</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'MOCK_ACTION_URL'</span><span class="p">)</span>
  <span class="n">script</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Script</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">to_json</span>
<span class="k">end</span>
</code></pre></div></div> <h3 id="parameters-14"> <a href="#parameters-14" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Parameters </h3> <div class="table-wrapper"><table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Notes</th> </tr> </thead> <tbody> <tr> <td><strong>actionUrl</strong></td> <td><strong>String</strong></td> <td>URL to which information on the completed recording is submitted. The PerCL received in response is then used to continue with Call processing.</td> <td> </td> </tr> <tr> <td><strong>silenceTimeoutMs</strong></td> <td><strong>Integer</strong></td> <td>Interval of silence that should elapse before ending the recording.</td> <td>[optional]</td> </tr> <tr> <td><strong>finishOnKey</strong></td> <td><strong>String</strong></td> <td>Key that triggers the end of the recording. any digit, ‘#’, or ‘*’</td> <td>[optional]</td> </tr> <tr> <td><strong>maxLengthSec</strong></td> <td><strong>Integer</strong></td> <td>Maximum length for the command execution in seconds.</td> <td>[optional]</td> </tr> <tr> <td><strong>playBeep</strong></td> <td><strong>Boolean</strong></td> <td>Indicates whether to play a beep sound before the start of the recording. If set to <code class="language-plaintext highlighter-rouge">false</code>, no beep is played.</td> <td>[optional]</td> </tr> <tr> <td><strong>autoStart</strong></td> <td><strong>Boolean</strong></td> <td>If <code class="language-plaintext highlighter-rouge">false</code>, recording begins immediately after the RecordUtterance command is processed. If <code class="language-plaintext highlighter-rouge">true</code>, recording begins when audio is present and if audio begins before the <code class="language-plaintext highlighter-rouge">maxLengthSec</code> timeout. If no audio begins before <code class="language-plaintext highlighter-rouge">maxLengthSec</code>, no recording is generated.</td> <td>[optional]</td> </tr> </tbody> </table></div> <h2 id="perclstartrecordcall"> <a href="#perclstartrecordcall" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Percl::StartRecordCall </h2> <p>The <code class="language-plaintext highlighter-rouge">StartRecordCall</code> command records the current call and returns the URL of a file containing the audio recording when recording completes.</p> <p><code class="language-plaintext highlighter-rouge">StartRecordCall</code> is non-blocking. After recording of the current call begins, control of the call moves to the PerCL command that follows <code class="language-plaintext highlighter-rouge">StartRecordCall</code> in the current PerCL script.</p> <h3 id="example-15"> <a href="#example-15" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Example </h3> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load the gems</span>
<span class="nb">require</span> <span class="s1">'sinatra'</span>
<span class="nb">require</span> <span class="s1">'freeclimb'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">post</span> <span class="s1">'/voice'</span> <span class="k">do</span> 
  <span class="n">record</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">StartRecordCall</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">script</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Script</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">to_json</span>
<span class="k">end</span>
</code></pre></div></div> <h3 id="parameters-15"> <a href="#parameters-15" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Parameters </h3> <p>none</p> <h2 id="perclplayearlymedia"> <a href="#perclplayearlymedia" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Percl::PlayEarlyMedia </h2> <p><code class="language-plaintext highlighter-rouge">PlayEarlyMedia</code> is relevant only when present as the very first command in the PerCL script returned for an incoming Call. In such cases, the command is executed before FreeClimb attempts to connect the call. The audio file it uses can be stored in any location that is accessible via URL.</p> <h3 id="example-16"> <a href="#example-16" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Example </h3> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load the gems</span>
<span class="nb">require</span> <span class="s1">'sinatra'</span>
<span class="nb">require</span> <span class="s1">'freeclimb'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">post</span> <span class="s1">'/voice'</span> <span class="k">do</span> 
  <span class="n">media</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">PlayEarlyMedia</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'MOCK_FILE_URL'</span><span class="p">)</span>
  <span class="n">script</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Script</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">media</span><span class="p">)</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">to_json</span>
<span class="k">end</span>
</code></pre></div></div> <h3 id="parameters-16"> <a href="#parameters-16" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Parameters </h3> <p>Name | Type | Description | Notes<br /> ————- | ————- | ————- | ————-<br /> <strong>file</strong> | <strong>String</strong> | URL of the audio file to be played to the caller. The URL can be the <code class="language-plaintext highlighter-rouge">recordingUrl</code> generated from the <code class="language-plaintext highlighter-rouge">RecordUtterance</code> or <code class="language-plaintext highlighter-rouge">StartRecordCall</code> PerCL commands or any accessible URL. FreeClimb will respect Cache-Control headers for this file. Use these to limit repeated requests for unchanged audio. If no Cache-Control header is provided, the file will be cached for seven days by default.</p> <h2 id="perclplay"> <a href="#perclplay" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Percl::Play </h2> <p>The <code class="language-plaintext highlighter-rouge">Play</code> command plays an audio file back to the caller. The audio file may be located at any location accessible via a URL. <code class="language-plaintext highlighter-rouge">Play</code> can exist as a stand-alone command or as a nested command. It does not allow barge-in unless nested within a <code class="language-plaintext highlighter-rouge">GetSpeech</code> command. The file will always be played to completion unless nested.</p> <h3 id="example-17"> <a href="#example-17" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Example </h3> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load the gems</span>
<span class="nb">require</span> <span class="s1">'sinatra'</span>
<span class="nb">require</span> <span class="s1">'freeclimb'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">post</span> <span class="s1">'/voice'</span> <span class="k">do</span> 
  <span class="n">play</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Play</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'MOCK_FILE_URL'</span><span class="p">)</span>
  <span class="n">script</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Script</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">play</span><span class="p">)</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">to_json</span>
<span class="k">end</span>
</code></pre></div></div> <h3 id="parameters-17"> <a href="#parameters-17" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Parameters </h3> <p>Name | Type | Description | Notes<br /> ————- | ————- | ————- | ————-<br /> <strong>file</strong> | <strong>String</strong> | URL of the audio file to be played to the caller. The URL can be the <code class="language-plaintext highlighter-rouge">recordingUrl</code> generated from the <code class="language-plaintext highlighter-rouge">RecordUtterance</code> or <code class="language-plaintext highlighter-rouge">StartRecordCall</code> PerCL commands. <br /> <strong>loop</strong> | <strong>Integer</strong> | Number of times the audio file is played. Specifying ‘0’ causes the Play action to loop until the Call is hung up. | [optional]<br /> <strong>conferenceId</strong> | <strong>String</strong> | ID of the Conference the audio should be rendered to. If this is not specified, the audio is by default rendered to the caller associated with the call leg that corresponds to the current PerCL execution context. The call leg associated with this command must be in the specified Conference or the command will return an error. | [optional]</p> <h2 id="perclsay"> <a href="#perclsay" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Percl::Say </h2> <p>The <code class="language-plaintext highlighter-rouge">Say</code> command provides Text-To-Speech (TTS) support. It converts text to speech and then renders it in a female voice back to the caller. <code class="language-plaintext highlighter-rouge">Say</code> is useful in cases where it’s difficult to pre-record a prompt for any reason. <code class="language-plaintext highlighter-rouge">Say</code> does not allow barge-in unless nested within a <code class="language-plaintext highlighter-rouge">GetSpeech</code> command. The file will always be played to completion unless nested.</p> <p>When translating text to speech, the <code class="language-plaintext highlighter-rouge">Say</code> action will make assumptions about how to pronounce numbers, dates, times, amounts of money and other abbreviations.</p> <h3 id="example-18"> <a href="#example-18" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Example </h3> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load the gems</span>
<span class="nb">require</span> <span class="s1">'sinatra'</span>
<span class="nb">require</span> <span class="s1">'freeclimb'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">post</span> <span class="s1">'/voice'</span> <span class="k">do</span> 
  <span class="n">say</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Say</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'Hello, World!'</span><span class="p">)</span>
  <span class="n">script</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Script</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">say</span><span class="p">)</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">to_json</span>
<span class="k">end</span>
</code></pre></div></div> <h3 id="parameters-18"> <a href="#parameters-18" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Parameters </h3> <p>Name | Type | Description | Notes<br /> ————- | ————- | ————- | ————-<br /> <strong>text</strong> | <strong>String</strong> | The message to be played to the caller using TTS. The size of the string is limited to 4 KB (or 4,096 bytes). An empty string will cause the command to be skipped.<br /> <strong>loop</strong> | <strong>Integer</strong> | Number of times the text is said. Specifying ‘0’ causes the <code class="language-plaintext highlighter-rouge">Say</code> action to loop until the Call is hung up. | [optional]<br /> <strong>language</strong> | <strong>String</strong> | Language and (by implication) the locale to use. This implies the accent and pronunciations to be usde for the TTS. The complete list of valid values for the language attribute is shown below. | [optional]<br /> <strong>conferenceId</strong> | <strong>String</strong> | ID of the Conference the speech should be rendered to. If this is not specified, the speech is by default rendered to the Caller associated with the call leg that corresponds to the current PerCL execution context. The call leg associated with this command must be in the specified Conference or the command will return an error. | [optional]<br /> <strong>enforcePCI</strong> | <strong>Boolean</strong> | Parameter <code class="language-plaintext highlighter-rouge">enforcePCI</code> will not log the ‘text’ as required by PCI compliance.</p> <h2 id="perclgetdigits"> <a href="#perclgetdigits" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Percl::GetDigits </h2> <p>The <code class="language-plaintext highlighter-rouge">GetDigits</code> command collects DTMF inputs from the caller. It is only supported only when there is a single party on the Call.</p> <p><code class="language-plaintext highlighter-rouge">GetDigits</code> is a Terminal Command — any actions following it are never executed. When the Caller is done entering the digits, FreeClimb submits that data to the provided <code class="language-plaintext highlighter-rouge">actionUrl</code> using an HTTP POST request. Your server will be required to respond to the FreeClimb Webhook with PerCL to continue handling the call.</p> <h3 id="example-19"> <a href="#example-19" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Example </h3> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load the gems</span>
<span class="nb">require</span> <span class="s1">'sinatra'</span>
<span class="nb">require</span> <span class="s1">'freeclimb'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">post</span> <span class="s1">'/voice'</span> <span class="k">do</span> 
  <span class="n">digits</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">GetDigits</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'MOCK_ACTION_URL'</span><span class="p">)</span>
  <span class="n">script</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Script</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">digits</span><span class="p">)</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">to_json</span>
<span class="k">end</span>
</code></pre></div></div> <h3 id="parameters-19"> <a href="#parameters-19" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Parameters </h3> <p>Name | Type | Description | Notes<br /> ————- | ————- | ————- | ————-<br /> <strong>actionUrl</strong> | <strong>String</strong> | When the Caller has finished entering digits, FreeClimb will make an HTTP POST request to this URL. A PerCL response is expected to continue handling the Call. Make sure to keep “http://“ in the URL.<br /> <strong>initialTimeoutMs</strong> | <strong>Integer</strong> | Maximum time in milliseconds that FreeClimb will wait for the Caller to press the first digit before making a determination that a <code class="language-plaintext highlighter-rouge">timeout</code> has occurred and moving on to make the request to the <code class="language-plaintext highlighter-rouge">actionUrl</code> to submit the results of the <code class="language-plaintext highlighter-rouge">GetDigits</code> command. This timeout interval begins when all nested commands have been fully executed. | [optional]<br /> <strong>digitTimeoutMs</strong> | <strong>Integer</strong> | Maximum time in milliseconds that FreeClimb will wait for the Caller to press any digit after the last digit entered, before making a determination that a <code class="language-plaintext highlighter-rouge">timeout</code> has occurred and moving on to make the request to the actionUrl to submit the results of the <code class="language-plaintext highlighter-rouge">GetDigits</code> command. This timeout interval begins and resets after each digit entered. | [optional]<br /> <strong>finishOnKey</strong> | <strong>String</strong> | Digit that causes the input sequence to be deemed complete. This attribute defers to the <code class="language-plaintext highlighter-rouge">timeout</code> attribute – so, if a <code class="language-plaintext highlighter-rouge">timeout</code> occurs, then the command terminates regardless of the value of <code class="language-plaintext highlighter-rouge">finishOnKey</code>. | [optional]<br /> <strong>minDigits</strong> | <strong>Integer</strong> | Minimum number of digits expected in the input. If specified, FreeClimb will return the collected digits only if the Caller has entered at least that many digits. | [optional]<br /> <strong>maxDigits</strong> | <strong>Integer</strong> | Maximum number of digits expected in the input. If the terminating digit is not entered and the caller has entered the maximum number of digits allowed, the <code class="language-plaintext highlighter-rouge">GetDigits</code> command terminates regardless of the value of <code class="language-plaintext highlighter-rouge">finishOnKey</code>. | [optional]<br /> <strong>prompts</strong> | <strong>String</strong> | JSON array of PerCL commands to nest within the <code class="language-plaintext highlighter-rouge">GetDigits</code> command. The <code class="language-plaintext highlighter-rouge">Say</code>, <code class="language-plaintext highlighter-rouge">Play</code>, and <code class="language-plaintext highlighter-rouge">Pause</code> commands can be used. The nested actions are executed while FreeClimb is waiting for input from the Caller. | [optional]<br /> <strong>enforcePCI</strong> | <strong>Boolean</strong> | Parameter <code class="language-plaintext highlighter-rouge">enforcePCI</code> obscures the result as required by PCI compliance.</p> <h2 id="perclgetspeech"> <a href="#perclgetspeech" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Percl::GetSpeech </h2> <p>The <code class="language-plaintext highlighter-rouge">GetSpeech</code> command enables the Caller to respond to the application using a supported language. Unlike DTMF entry, which implicitly restricts the user to using the available buttons on the phone key pad, speech input allows for flexible audio inputs based on grammar. FreeClimb supports grammars written using GRXML compatible with the Microsoft Speech Platform.</p> <p><code class="language-plaintext highlighter-rouge">GetSpeech</code> is only supported on a single call leg. It is not supported when there are two or more call legs connected (as in within a Conference).</p> <h3 id="example-20"> <a href="#example-20" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Example </h3> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load the gems</span>
<span class="nb">require</span> <span class="s1">'sinatra'</span>
<span class="nb">require</span> <span class="s1">'freeclimb'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">post</span> <span class="s1">'/voice'</span> <span class="k">do</span> 
  <span class="n">speech</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">GetSpeech</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'MOCK_ACTION_URL'</span><span class="p">,</span> <span class="s1">'MOCK_GRAMMAR_FILE'</span><span class="p">)</span>
  <span class="n">script</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Script</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">speech</span><span class="p">)</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">to_json</span>
<span class="k">end</span>
</code></pre></div></div> <h3 id="parameters-20"> <a href="#parameters-20" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Parameters </h3> <p>Name | Type | Description | Notes<br /> ————- | ————- | ————- | ————-<br /> <strong>actionUrl</strong> | <strong>String</strong> | When the caller has finished speaking or the command has timed out, FreeClimb will make a POST request to this URL. A PerCL response is expected to continue handling the call.<br /> <strong>grammarFile</strong> | <strong>String</strong> | The grammar file to use for speech recognition. If grammarType is set to URL, this attribute is specified as a download URL.<br /> <strong>grammarType</strong> | <strong>String</strong> | The grammar file type to use for speech recognition. A value of ‘URL’ indicates the grammarFile attribute specifies a URL that points to the grammar file. A value of ‘BUILTIN’ indicates the grammarFile attribute specifies the name of one of the platform built-in grammar files. | [optional]<br /> <strong>grammarRule</strong> | <strong>String</strong> | The grammar rule within the specified grammar file to use for speech recognition. This attribute is optional if <code class="language-plaintext highlighter-rouge">grammarType</code> is <code class="language-plaintext highlighter-rouge">URL</code> and ignored if <code class="language-plaintext highlighter-rouge">grammarType</code> is <code class="language-plaintext highlighter-rouge">BUILTIN</code>. | [optional if <code class="language-plaintext highlighter-rouge">grammarType</code> is <code class="language-plaintext highlighter-rouge">URL</code>]<br /> <strong>playBeep</strong> | <strong>Boolean</strong> | Indicates whether a beep should be played just before speech recognition is initiated so that the speaker can start to speak. | [optional]<br /> <strong>prompts</strong> | <strong>Percl Commands Array</strong> | The JSON array of PerCL commands to nest within the <code class="language-plaintext highlighter-rouge">GetSpeech</code> command. The <code class="language-plaintext highlighter-rouge">Say</code>, <code class="language-plaintext highlighter-rouge">Play</code>, and <code class="language-plaintext highlighter-rouge">Pause</code> commands can be used. The nested actions are executed while FreeClimb is waiting for input from the caller. This allows for playing menu options to the caller and to prompt for the expected input. These commands stop executing when the caller begins to input speech. | [optional]<br /> <strong>noInputTimeoutMs</strong> | <strong>Integer</strong> | When recognition is started and there is no speech detected for <code class="language-plaintext highlighter-rouge">noInputTimeoutMs</code> milliseconds, the recognizer will terminate the recognition operation. | [optional]<br /> <strong>recognitionTimeoutMs</strong> | <strong>Integer</strong> | When playback of prompts ends and there is no match for <code class="language-plaintext highlighter-rouge">recognitionTimeoutMs</code> milliseconds, the recognizer will terminate the recognition operation. | [optional]<br /> <strong>confidenceThreshold</strong> | <strong>Float</strong> | When a recognition resource recognizes a spoken phrase, it associates a confidence level with that match. Parameter <code class="language-plaintext highlighter-rouge">confidenceThreshold</code> specifies what confidence level is considered a successful match. Values are between 0.0 and 1.0. | [optional]<br /> <strong>sensitivityLevel</strong> | <strong>Float</strong> | The speech recognizer supports a variable level of sound sensitivity. The sensitivityLevel attribute allows for filtering out background noise, so it is not mistaken for speech. Values are between 0.0 and 1.0 | [optional]<br /> <strong>speechCompleteTimeoutMs</strong> | <strong>Integer</strong> | Parameter <code class="language-plaintext highlighter-rouge">speechCompleteTimeoutMs</code> specifies the length of silence required following user speech before the speech recognizer finalizes a result. This timeout applies when the recognizer currently has a complete match against an active grammar. Reasonable speech complete timeout values are typically in the range of 0.3 seconds to 1.0 seconds. | [optional]<br /> <strong>speechIncompleteTimeoutMs</strong> | <strong>Integer</strong> | Parameter <code class="language-plaintext highlighter-rouge">speechIncompleteTimeoutMs</code> specifies the length of silence following user speech after which a recognizer finalizes a result. This timeout applies when the speech prior to the silence is an incomplete match of all active grammars. Timeout <code class="language-plaintext highlighter-rouge">speechIncompleteTimeoutMs</code> is usually longer than <code class="language-plaintext highlighter-rouge">speechCompleteTimeoutMs</code> to allow users to pause mid-utterance. | [optional]<br /> <strong>enforcePCI</strong> | <strong>Boolean</strong> | Parameter enforcePCI will not log the ‘text’ as required by PCI compliance. | [optional]</p> <h2 id="perclsms"> <a href="#perclsms" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Percl::Sms </h2> <p>The <code class="language-plaintext highlighter-rouge">Sms</code> command can be used to send an SMS message to a phone number during a phone call.</p> <p>International SMS is disabled by default.</p> <h3 id="example-21"> <a href="#example-21" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Example </h3> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load the gems</span>
<span class="nb">require</span> <span class="s1">'sinatra'</span>
<span class="nb">require</span> <span class="s1">'freeclimb'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">post</span> <span class="s1">'/voice'</span> <span class="k">do</span> 
  <span class="n">sms</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Sms</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'MOCK_TO_NUMBER'</span><span class="p">,</span> <span class="s1">'MOCK_FROM_NUMBER'</span><span class="p">,</span> <span class="s1">'MOCK_TEXT'</span><span class="p">)</span>
  <span class="n">script</span> <span class="o">=</span> <span class="no">Percl</span><span class="o">::</span><span class="no">Script</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">sms</span><span class="p">)</span>
  <span class="n">script</span><span class="p">.</span><span class="nf">to_json</span>
<span class="k">end</span>
</code></pre></div></div> <h3 id="parameters-21"> <a href="#parameters-21" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Parameters </h3> <div class="table-wrapper"><table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Notes</th> </tr> </thead> <tbody> <tr> <td><strong>to</strong></td> <td><strong>String</strong></td> <td>E.164 representation of the phone number to which the message will be sent. Must be within FreeClimb’s service area and E.164 formatting (e.g., +18003608245).</td> <td> </td> </tr> <tr> <td><strong>from</strong></td> <td><strong>String</strong></td> <td>E.164 representation of the phone number to use as the sender. This must be an incoming phone number you have purchased from FreeClimb.</td> <td> </td> </tr> <tr> <td><strong>text</strong></td> <td><strong>String</strong></td> <td>Text contained in the message (maximum 160 characters).</td> <td> </td> </tr> <tr> <td><strong>notificationUrl</strong></td> <td><strong>String</strong></td> <td>When the message changes status, this URL will be invoked using HTTP POST with the messageStatus parameters. This is a notification only; any PerCL returned will be ignored.</td> <td> </td> </tr> </tbody> </table></div> </div> </div> </div> </div> </body> </html>
